<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Результаты Опроса: Система "Лектор.AI"</title>
    <!-- Подключение Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
            color: #1e293b;
        }
        .result-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .result-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .progress-bar-fill {
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-7xl mx-auto">
        <!-- Шапка -->
        <header class="mb-10 bg-white rounded-2xl shadow-sm border border-gray-100 p-8 relative overflow-hidden">
            <div class="absolute top-0 right-0 w-32 h-32 bg-blue-50 rounded-bl-full -mr-8 -mt-8 z-0"></div>
            <div class="relative z-10">
                <div class="flex items-center gap-3 mb-2">
                    <span class="px-3 py-1 bg-blue-100 text-blue-700 text-xs font-bold uppercase tracking-wider rounded-full">Отчет</span>
                    <span class="text-gray-400 text-xs font-medium">Обновлено: Декабрь 2025</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-extrabold text-slate-800 mb-4 tracking-tight">Аналитика "Лектор.AI"</h1>
                <p class="text-slate-600 text-lg max-w-2xl">
                    Результаты анкетирования по внедрению системы умного поиска по видеолекциям.
                    <br>Аудитория: <span class="font-semibold text-blue-600">Студенты АГПУ</span> (N = <span id="total-respondents" class="font-bold">...</span>)
                </p>
            </div>
        </header>

        <!-- KPI Панель -->
        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
            <!-- KPI 1 -->
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between h-full">
                <div>
                    <div class="text-gray-500 text-sm font-medium mb-1">Сложность поиска сейчас</div>
                    <div class="text-xs text-gray-400 mb-4">Согласны, что искать сложно</div>
                </div>
                <div class="flex items-end justify-between">
                    <span id="stat-difficulty" class="text-4xl font-bold text-red-500">...</span>
                    <div class="p-2 bg-red-50 rounded-lg text-red-500">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                </div>
            </div>

            <!-- KPI 2 -->
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between h-full">
                <div>
                    <div class="text-gray-500 text-sm font-medium mb-1">Экономия времени</div>
                    <div class="text-xs text-gray-400 mb-4">Ожидают экономию >10%</div>
                </div>
                <div class="flex items-end justify-between">
                    <span id="stat-time-saving" class="text-4xl font-bold text-amber-500">...</span>
                    <div class="p-2 bg-amber-50 rounded-lg text-amber-500">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                </div>
            </div>

            <!-- KPI 3 -->
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between h-full">
                <div>
                    <div class="text-gray-500 text-sm font-medium mb-1">Востребованность</div>
                    <div class="text-xs text-gray-400 mb-4">"Критически необходимый"</div>
                </div>
                <div class="flex items-end justify-between">
                    <span id="stat-necessity" class="text-4xl font-bold text-emerald-600">...</span>
                    <div class="p-2 bg-emerald-50 rounded-lg text-emerald-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                </div>
            </div>

            <!-- KPI 4 -->
            <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-between h-full">
                <div>
                    <div class="text-gray-500 text-sm font-medium mb-1">Функция "Индекс"</div>
                    <div class="text-xs text-gray-400 mb-4">Оценка "Крайне полезно"</div>
                </div>
                <div class="flex items-end justify-between">
                    <span id="stat-index-utility" class="text-4xl font-bold text-indigo-600">...</span>
                    <div class="p-2 bg-indigo-50 rounded-lg text-indigo-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                    </div>
                </div>
            </div>
        </section>

        <!-- Графики -->
        <div id="results-container" class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Сюда JS вставит графики -->
        </div>

        <!-- Комментарии -->
        <section class="mt-12 bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
            <div class="p-6 bg-slate-50 border-b border-gray-100">
                <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    Открытые комментарии
                </h2>
            </div>
            <div class="p-6">
                <ul id="comments-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Комментарии -->
                </ul>
            </div>
        </section>

        <footer class="mt-12 text-center text-gray-400 text-sm pb-8">
            <p>&copy; 2025 Аналитика образовательных данных АГПУ</p>
        </footer>
    </div>

    <script>
        // Исходные данные
        const rawData = `
Ваш статус в АГПУ: / Студент	Ваш статус в АГПУ: / Преподаватель/Сотрудник	Ваш статус в АГПУ: / Администрация	Как часто вы используете видеолекции или записи учебных занятий в своей работе/учебе?	Насколько вы согласны со следующим утверждением: "Найти конкретную информацию (цитату, определение, формулу) в длинной видеолекции занимает слишком много времени и вызывает сложности."	Если бы вы хотели быстро найти информацию в видеолекции, как бы вы это сделали сейчас? (Выберите все подходящие варианты)	Насколько важна для вас возможность иметь 100% доступность учебного видеоконтента (например, из-за проблем со слухом, языковым барьером, просмотром в шумной обстановке)?	Насколько полезной для вас будет функция "Цифровой индекс" (возможность искать ЛЮБОЕ слово или фразу внутри часовой видеолекции и мгновенно переходить к этому моменту)?	Насколько полезной для вас будет функция "Авто-конспекты" (автоматическое создание структурированного PDF-конспекта лекции на основе ее субтитров)?	Как бы вы оценили потенциальную экономию ВРЕМЕНИ, которую даст вам "Лектор.AI" при подготовке к экзаменам/поиске материала?	Если бы "Лектор.AI" был доступен сегодня, как бы вы оценили его необходимость для АГПУ в целом?	Пожалуйста, оставьте любые комментарии или предложения по поводу системы "Лектор.AI" или того, какие еще проблемы она могла бы решить.
Студент			Ежедневно	Нейтрально	Искал бы информацию в конспектах, которые вел сам.	Нейтрально	Нейтрально	Нейтрально	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Редко или никогда	Нейтрально	Искал бы информацию в конспектах, которые вел сам.	Нейтрально	Нейтрально	Полезно	Сэкономит очень много времени (более 30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в месяц	Согласен	Полагался бы на тайм-коды, если они есть.	Важна	Полезно	Полезно	Сэкономит значительное время (10-30%)	Важный проект, который улучшит учебный процесс.	Будет круто
Студент			Редко или никогда	Полностью не согласен	Искал бы информацию в конспектах, которые вел сам.	Совершенно не важна	Полезно	Полезно	Сэкономит немного времени (до 10%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	всё супер спасибо
Студент			Ежедневно	Полностью не согласен	Прокручивал бы видео наугад, пока не найду нужный момент.	Совершенно не важна	Совершенно не полезно	Совершенно не полезно	Не сэкономит время	Ненужный проект, не решает реальных проблем.	Помогла подготовить несколько презентаций
Студент			Ежедневно	Нейтрально	Искал бы информацию в конспектах, которые вел сам.	Важна	Полезно	Крайне полезно	Сэкономит очень много времени (более 30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в неделю	Не согласен	Полагался бы на тайм-коды, если они есть.	Важна	Полезно	Полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Не согласен	Искал бы информацию в конспектах, которые вел сам.	Совершенно не важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Ежедневно	Нейтрально	Полагался бы на тайм-коды, если они есть.	Нейтрально	Нейтрально	Полезно	Сэкономит очень много времени (более 30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в месяц	Полностью согласен	Полагался бы на тайм-коды, если они есть.	Нейтрально	Крайне полезно	Крайне полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	Мне бы это понравилось и было полезно
Студент			Несколько раз в неделю	Полностью согласен	Прокручивал бы видео наугад, пока не найду нужный момент.	Важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Важный проект, который улучшит учебный процесс.	
Студент			Редко или никогда	Согласен	Прокручивал бы видео наугад, пока не найду нужный момент.	Не важна	Полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в месяц	Согласен	Полагался бы на тайм-коды, если они есть.	Важна	Крайне полезно	Не полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	Положительно-отлично-успешно-восхитительно-полезное приспособление для понимания и быстрого решения данной проблемы по производству улучшенного способа передачи знаний, а не их производства у самого человека
Студент			Несколько раз в неделю	Согласен	Искал бы информацию в конспектах, которые вел сам.	Важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Искал бы информацию в конспектах, которые вел сам.	Важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Ежедневно	Согласен	Вообще не стал бы тратить время на поиск в видео.	Нейтрально	Полезно	Полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Нейтрально	Полагался бы на тайм-коды, если они есть.	Нейтрально	Полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в неделю	Согласен	Пытался бы найти информацию в учебнике/поисковике.	Критически важна	Полезно	Полезно	Сэкономит значительное время (10-30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Ежедневно	Согласен	Полагался бы на тайм-коды, если они есть.	Важна	Крайне полезно	Крайне полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Ежедневно	Полностью согласен	Пытался бы найти информацию в учебнике/поисковике.	Важна	Полезно	Полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Полностью согласен	Искал бы информацию в конспектах, которые вел сам.	Важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Полностью согласен	Искал бы информацию в конспектах, которые вел сам.	Важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Полностью согласен	Искал бы информацию в конспектах, которые вел сам.	Важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в месяц	Нейтрально	Полагался бы на тайм-коды, если они есть.	Важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Важный проект, который улучшит учебный процесс.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Полностью согласен	Искал бы информацию в конспектах, которые вел сам.	Критически важна	Полезно	Крайне полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Полностью согласен	Искал бы информацию в конспектах, которые вел сам.	Критически важна	Полезно	Крайне полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Ежедневно	Полностью согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Крайне полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Согласен	Вообще не стал бы тратить время на поиск в видео.	Критически важна	Крайне полезно	Полезно	Сэкономит значительное время (10-30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Редко или никогда	Полностью согласен	Полагался бы на тайм-коды, если они есть.	Важна	Крайне полезно	Крайне полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	надеюсь на воплощение этого проекта в жизнь!
Студент			Ежедневно	Полностью не согласен	Искал бы информацию в конспектах, которые вел сам.	Важна	Полезно	Полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в неделю	Нейтрально	Искал бы информацию в конспектах, которые вел сам.	Нейтрально	Нейтрально	Нейтрально	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
Студент			Несколько раз в месяц	Нейтрально	Полагался бы на тайм-коды, если они есть.	Важна	Полезно	Полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	
	Преподаватель/Сотрудник	Администрация	Ежедневно	Полностью согласен	Полагался бы на тайм-коды, если они есть.	Критически важна	Нейтрально	Не полезно	Сэкономит очень много времени (более 30%)	Критически необходимый проект, который превратит видеоархив в ценный актив.	помогите мне кто нибудь прошу
        `;

        // ==========================================
        // CONFIG
        // ==========================================
        const QUESTIONS_CONFIG = [
            { 
                key: 'usageFrequency', 
                title: '1. Частота использования видеолекций', 
                type: 'single' 
            },
            { 
                key: 'searchDifficulty', 
                title: '2. "Искать информацию в видео сложно и долго"', 
                type: 'single',
                order: ['Полностью согласен', 'Согласен', 'Нейтрально', 'Не согласен', 'Полностью не согласен'],
                colorMap: {
                    'Полностью согласен': 'bg-red-500',
                    'Согласен': 'bg-red-400',
                    'Нейтрально': 'bg-gray-400',
                    'Не согласен': 'bg-emerald-400',
                    'Полностью не согласен': 'bg-emerald-500'
                }
            },
            { 
                key: 'currentSearchMethod', 
                title: '3. Как вы ищете информацию сейчас? (Множ. выбор)', 
                type: 'multiple', 
                // ИСПРАВЛЕНИЕ: Используем плейсхолдер {N} вместо жесткого числа
                note: 'Процент от числа студентов (N={N}), сумма может превышать 100%'
            },
            { 
                key: 'digitalIndexUtility', 
                title: '4. Полезность функции "Цифровой индекс"', 
                type: 'single',
                order: ['Крайне полезно', 'Полезно', 'Нейтрально', 'Не полезно', 'Совершенно не полезно'],
                colorMap: {
                    'Крайне полезно': 'bg-indigo-600',
                    'Полезно': 'bg-indigo-400',
                    'Нейтрально': 'bg-gray-400',
                    'Не полезно': 'bg-slate-400',
                    'Совершенно не полезно': 'bg-slate-300'
                }
            },
            { 
                key: 'autoNotesUtility', 
                title: '5. Полезность функции "Авто-конспекты"', 
                type: 'single',
                order: ['Крайне полезно', 'Полезно', 'Нейтрально', 'Не полезно', 'Совершенно не полезно'],
                colorMap: {
                    'Крайне полезно': 'bg-teal-600',
                    'Полезно': 'bg-teal-400',
                    'Нейтрально': 'bg-gray-400',
                    'Не полезно': 'bg-slate-400',
                    'Совершенно не полезно': 'bg-slate-300'
                }
            },
            { 
                key: 'timeSaving', 
                title: '6. Оценка экономии времени', 
                type: 'single',
                order: ['Сэкономит очень много времени (более 30%)', 'Сэкономит значительное время (10-30%)', 'Сэкономит немного времени (до 10%)', 'Не сэкономит время'],
                colorMap: {
                    'Сэкономит очень много времени (более 30%)': 'bg-amber-500',
                    'Сэкономит значительное время (10-30%)': 'bg-amber-400',
                    'Сэкономит немного времени (до 10%)': 'bg-amber-200',
                    'Не сэкономит время': 'bg-gray-400'
                }
            },
            { 
                key: 'projectNecessity', 
                title: '7. Необходимость проекта "Лектор.AI"', 
                type: 'single',
                order: ['Критически необходимый проект, который превратит видеоархив в ценный актив.', 'Важный проект, который улучшит учебный процесс.', 'Ненужный проект, не решает реальных проблем.'],
                colorMap: {
                    'Критически необходимый проект, который превратит видеоархив в ценный актив.': 'bg-emerald-600',
                    'Важный проект, который улучшит учебный процесс.': 'bg-emerald-400',
                    'Ненужный проект, не решает реальных проблем.': 'bg-red-400'
                }
            }
        ];

        // ==========================================
        // 1. ПАРСИНГ ДАННЫХ
        // ==========================================

        function parseData(rawData) {
            // Более надежная разбивка на строки
            const lines = rawData.trim().split('\n').filter(line => line.trim().length > 0);
            if (lines.length <= 1) return [];

            const dataLines = lines.slice(1);
            const delimiter = '\t';

            const protectedPhrases = [
                { original: "конспектах, которые", temp: "конспектах##COMMA## которые" },
                { original: "тайм-коды, если", temp: "тайм-коды##COMMA## если" },
                { original: "наугад, пока", temp: "наугад##COMMA## пока" },
            ];

            const allResponses = dataLines.map(line => {
                const values = line.split(delimiter);
                
                const r = {
                    statusStudent: values[0] || '',
                    statusTeacher: values[1] || '',
                    statusAdmin: values[2] || '',
                    usageFrequency: values[3] || '',
                    searchDifficulty: values[4] || '',
                    currentSearchMethod: values[5] || '', 
                    accessibilityImportance: values[6] || '',
                    digitalIndexUtility: values[7] || '',
                    autoNotesUtility: values[8] || '',
                    timeSaving: values[9] || '',
                    projectNecessity: values[10] || '',
                    comments: values[11] || '',
                };

                // Очистка проблемного поля
                let methodsRaw = r.currentSearchMethod;
                protectedPhrases.forEach(p => {
                    methodsRaw = methodsRaw.split(p.original).join(p.temp);
                });

                const methodsArray = methodsRaw.split(',').map(m => {
                    let cleanMethod = m.trim();
                    protectedPhrases.forEach(p => {
                        cleanMethod = cleanMethod.split(p.temp).join(p.original);
                    });
                    return cleanMethod;
                }).filter(m => m !== '');
                
                r.currentSearchMethodParsed = methodsArray;

                // Более надежная проверка роли
                if (r.statusStudent.trim() !== '') {
                    r.role = 'Student';
                } else if (r.statusTeacher.trim() !== '' || r.statusAdmin.trim() !== '') {
                    r.role = 'Other';
                } else {
                    r.role = 'Unknown';
                }

                return r;
            }).filter(res => res.role === 'Student'); 

            return allResponses;
        }

        // ==========================================
        // 2. РАСЧЕТ СТАТИСТИКИ
        // ==========================================

        function calculateStats(responses) {
            const totalStudents = responses.length;
            const stats = {};

            QUESTIONS_CONFIG.forEach(q => {
                const counts = {};
                
                responses.forEach(r => {
                    if (q.type === 'multiple') {
                        r.currentSearchMethodParsed.forEach(method => {
                            counts[method] = (counts[method] || 0) + 1;
                        });
                    } else {
                        const val = r[q.key];
                        if (val) counts[val] = (counts[val] || 0) + 1;
                    }
                });

                let sortedCounts = Object.entries(counts);
                if (q.order) {
                    sortedCounts.sort(([a], [b]) => {
                        const idxA = q.order.indexOf(a);
                        const idxB = q.order.indexOf(b);
                        return (idxA === -1 ? 999 : idxA) - (idxB === -1 ? 999 : idxB);
                    });
                } else {
                    sortedCounts.sort(([, a], [, b]) => b - a);
                }

                stats[q.key] = {
                    title: q.title,
                    type: q.type,
                    note: q.note,
                    results: sortedCounts.map(([label, count]) => {
                        const percentage = ((count / totalStudents) * 100).toFixed(1);
                        
                        let color = 'bg-blue-500';
                        if (q.colorMap && q.colorMap[label]) {
                            color = q.colorMap[label];
                        } else {
                            const defaultColors = ['bg-blue-600', 'bg-blue-500', 'bg-blue-400', 'bg-blue-300', 'bg-blue-200'];
                            const idx = sortedCounts.findIndex(item => item[0] === label);
                            color = defaultColors[idx % defaultColors.length];
                        }

                        return { label, count, percentage, color };
                    })
                };
            });
            
            const difficultyCount = (responses.filter(r => ['Полностью согласен', 'Согласен'].includes(r.searchDifficulty)).length / totalStudents * 100).toFixed(0);
            const timeSavingCount = (responses.filter(r => ['Сэкономит очень много времени (более 30%)', 'Сэкономит значительное время (10-30%)'].includes(r.timeSaving)).length / totalStudents * 100).toFixed(0);
            const necessityCount = (responses.filter(r => r.projectNecessity.startsWith('Критически')).length / totalStudents * 100).toFixed(0);
            const indexUtilityCount = (responses.filter(r => r.digitalIndexUtility === 'Крайне полезно').length / totalStudents * 100).toFixed(0);

            return { total: totalStudents, stats, difficultyCount, timeSavingCount, necessityCount, indexUtilityCount };
        }

        // ==========================================
        // 3. РЕНДЕРИНГ
        // ==========================================

        function renderResults(data) {
            document.getElementById('total-respondents').textContent = data.total;
            document.getElementById('stat-difficulty').textContent = `${data.difficultyCount}%`;
            document.getElementById('stat-time-saving').textContent = `${data.timeSavingCount}%`;
            document.getElementById('stat-necessity').textContent = `${data.necessityCount}%`;
            document.getElementById('stat-index-utility').textContent = `${data.indexUtilityCount}%`;

            const container = document.getElementById('results-container');
            container.innerHTML = '';

            QUESTIONS_CONFIG.forEach(q => {
                const statData = data.stats[q.key];
                if (!statData) return;

                let barsHtml = '';
                statData.results.forEach(item => {
                    barsHtml += `
                        <div class="mb-5 last:mb-0 group">
                            <div class="flex justify-between text-sm font-medium text-slate-700 mb-1 group-hover:text-blue-700 transition-colors">
                                <span class="w-3/4 truncate pr-2" title="${item.label}">${item.label}</span>
                                <span>${item.percentage}% <span class="text-slate-400 text-xs ml-1 font-normal">(${item.count})</span></span>
                            </div>
                            <div class="w-full bg-slate-100 rounded-full h-2.5 overflow-hidden">
                                <div class="progress-bar-fill ${item.color} h-2.5 rounded-full" style="width: 0%" data-width="${item.percentage}"></div>
                            </div>
                        </div>
                    `;
                });

                // ИСПРАВЛЕНИЕ: Динамическая подстановка числа студентов в сноску
                let noteHtml = '';
                if (statData.note) {
                    const cleanNote = statData.note.replace('{N}', data.total);
                    noteHtml = `<p class="text-xs text-gray-400 mt-4 pt-2 border-t border-gray-100 italic">${cleanNote}</p>`;
                }

                const cardHtml = `
                    <div class="result-card bg-white p-6 rounded-2xl shadow-sm border border-gray-100 flex flex-col h-full">
                        <h3 class="text-lg font-bold text-slate-800 mb-6 flex items-start gap-2">
                            ${statData.title}
                        </h3>
                        <div class="flex-grow">
                            ${barsHtml}
                        </div>
                        ${noteHtml}
                    </div>
                `;
                container.innerHTML += cardHtml;
            });
        }

        function renderComments(responses) {
            const list = document.getElementById('comments-list');
            const comments = responses
                .map(r => r.comments)
                .filter(c => c && c.trim() !== '' && c.trim() !== 'Column 13' && c.toLowerCase() !== 'нет');

            if (comments.length === 0) {
                list.innerHTML = '<li class="text-gray-400 italic col-span-2 text-center py-4">Нет содержательных комментариев.</li>';
                return;
            }

            comments.forEach(comment => {
                const colors = ['bg-blue-100 text-blue-600', 'bg-indigo-100 text-indigo-600', 'bg-emerald-100 text-emerald-600', 'bg-amber-100 text-amber-600'];
                const randColor = colors[Math.floor(Math.random() * colors.length)];
                
                list.innerHTML += `
                    <li class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex gap-3">
                        <div class="flex-shrink-0 w-8 h-8 rounded-full ${randColor} flex items-center justify-center font-bold text-xs">
                            С
                        </div>
                        <p class="text-sm text-slate-700 leading-relaxed italic">"${comment}"</p>
                    </li>
                `;
            });
        }

        window.onload = function() {
            const studentResponses = parseData(rawData);
            const stats = calculateStats(studentResponses);
            
            renderResults(stats);
            renderComments(studentResponses);
            
            setTimeout(() => {
                document.querySelectorAll('.progress-bar-fill').forEach(bar => {
                    bar.style.width = `${bar.getAttribute('data-width')}%`;
                });
            }, 300);
        };
    </script>
</body>
</html>